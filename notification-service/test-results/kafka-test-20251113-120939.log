========================================
Notification Service Kafka Consumer Test
Start Time: 2025ë…„ 11ì›” 13ì¼ ëª© ì˜¤í›„ 12:09:39
========================================

[0;34m[PREREQUISITE] Kafka ë¸Œë¡œì»¤ ì—°ê²° í™•ì¸[0m
[0;32mâœ… Kafka ë¸Œë¡œì»¤ ì—°ê²° ì„±ê³µ[0m

[0;34m[PREREQUISITE] notification-service ì—°ê²° í™•ì¸[0m
[0;32mâœ… notification-service ì‹¤í–‰ ì¤‘[0m

[0;34m[TEST 1] order.created ì´ë²¤íŠ¸ ë°œí–‰ â†’ ì•Œë¦¼ ìƒì„± í™•ì¸[0m
Event ID: test-event-6b8e6ced-aa4c-438c-bb11-e89640ffcdb4
Order ID: 1f449928-e6d8-4100-aed4-f4b7cbba4b51
Kafka Message:
{
  "eventId": "test-event-6b8e6ced-aa4c-438c-bb11-e89640ffcdb4",
  "occurredAt": "2025-11-13T03:09:48.000Z",
  "order": {
    "orderId": "1f449928-e6d8-4100-aed4-f4b7cbba4b51",
    "ordererInfo": "í…ŒìŠ¤íŠ¸ì£¼ë¬¸ì / test@example.com",
    "requestingCompanyName": "ê³µê¸‰ì—…ì²´",
    "receivingCompanyName": "ìˆ˜ë ¹ì—…ì²´",
    "productInfo": "í…ŒìŠ¤íŠ¸ ìƒí’ˆ x 10",
    "requestDetails": "ë¹ ë¥¸ ë°°ì†¡ ë¶€íƒë“œë¦½ë‹ˆë‹¤",
    "route": {
      "startHubId": "853e1ee2-5844-427d-aa90-97889de41776",
      "startHubName": "ì„œìš¸ì„¼í„°",
      "waypointHubNames": ["ëŒ€ì „ì„¼í„°"],
      "destinationHubId": "15b1e3d2-e9b8-4914-b87e-60ffbda7f411",
      "destinationHubName": "ë¶€ì‚°ì„¼í„°"
    },
    "receiver": {
      "name": "ê¹€ìˆ˜ë ¹",
      "address": "ë¶€ì‚°ì‹œ í•´ìš´ëŒ€êµ¬",
      "slackId": "U01234567"
    },
    "hubManager": {
      "slackId": "C09QY22AMEE",
      "name": "Test Manager"
    }
  }
}
âœ… Kafka ë©”ì‹œì§€ ë°œí–‰ ì™„ë£Œ
â³ Consumer ì²˜ë¦¬ ëŒ€ê¸° ì¤‘ (5ì´ˆ)...

[1;33mâš ï¸ ì•Œë¦¼ ìƒì„± í™•ì¸ì€ notification-service ë¡œê·¸ ë˜ëŠ” DBë¥¼ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”.[0m
[1;33mì˜ˆìƒ ë¡œê·¸: ğŸ“¦ Received order.created event - eventId: test-event-6b8e6ced-aa4c-438c-bb11-e89640ffcdb4[0m

ìˆ˜ë™ ê²€ì¦ ë°©ë²•:
1. Docker ë¡œê·¸ í™•ì¸:
   docker logs notification-service | grep 'test-event-6b8e6ced-aa4c-438c-bb11-e89640ffcdb4'

2. DB í™•ì¸ (H2 Console ë˜ëŠ” PostgreSQL):
   SELECT * FROM p_notifications WHERE event_id = 'test-event-6b8e6ced-aa4c-438c-bb11-e89640ffcdb4';

[0;32mâœ… í…ŒìŠ¤íŠ¸ ì™„ë£Œ (ìˆ˜ë™ ê²€ì¦ í•„ìš”)[0m

[0;34m[TEST 2] ë©±ë“±ì„± ê²€ì¦ - ë™ì¼í•œ eventIdë¡œ ì¤‘ë³µ ë°œí–‰[0m
ë™ì¼í•œ Event IDë¡œ ì¬ë°œí–‰: test-event-6b8e6ced-aa4c-438c-bb11-e89640ffcdb4
âœ… Kafka ë©”ì‹œì§€ ì¬ë°œí–‰ ì™„ë£Œ
â³ Consumer ì²˜ë¦¬ ëŒ€ê¸° ì¤‘ (5ì´ˆ)...

[1;33mâš ï¸ ë©±ë“±ì„± í™•ì¸: ë™ì¼í•œ eventIdë¡œ 2ë²ˆ ë°œí–‰í–ˆì§€ë§Œ, ì•Œë¦¼ì€ 1ê°œë§Œ ìƒì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.[0m
[1;33mì˜ˆìƒ ë¡œê·¸: â­ï¸ Event already processed (idempotency) - eventId: test-event-6b8e6ced-aa4c-438c-bb11-e89640ffcdb4[0m

ìˆ˜ë™ ê²€ì¦ ë°©ë²•:
1. Docker ë¡œê·¸ í™•ì¸ (ë©±ë“±ì„± ë¡œê·¸):
   docker logs notification-service | grep 'idempotency' | grep 'test-event-6b8e6ced-aa4c-438c-bb11-e89640ffcdb4'

2. DB í™•ì¸ (1ê°œë§Œ ì¡´ì¬í•´ì•¼ í•¨):
   SELECT COUNT(*) FROM p_notifications WHERE event_id = 'test-event-6b8e6ced-aa4c-438c-bb11-e89640ffcdb4';
   (ê²°ê³¼: 1)

[0;32mâœ… í…ŒìŠ¤íŠ¸ ì™„ë£Œ (ìˆ˜ë™ ê²€ì¦ í•„ìš”)[0m

[0;34m[TEST 3] delivery.status.changed ì´ë²¤íŠ¸ ë°œí–‰ â†’ ì•Œë¦¼ ìƒì„± í™•ì¸[0m
Event ID: test-delivery-event-d99460c5-2686-47fd-afe7-a0aa8cdee4c3
Delivery ID: 87580571-f572-4581-82af-4f908a0b25f2
Kafka Message:
{
  "eventId": "test-delivery-event-d99460c5-2686-47fd-afe7-a0aa8cdee4c3",
  "occurredAt": "2025-11-13T03:10:11.000Z",
  "delivery": {
    "deliveryId": "87580571-f572-4581-82af-4f908a0b25f2",
    "orderId": "ccb583b3-4bfb-4c1a-bfe7-e6e4092ead17",
    "previousStatus": "HUB_WAITING",
    "currentStatus": "HUB_MOVING",
    "recipientSlackId": "C09QY22AMEE",
    "recipientName": "Test Hub Manager"
  }
}
âœ… Kafka ë©”ì‹œì§€ ë°œí–‰ ì™„ë£Œ
â³ Consumer ì²˜ë¦¬ ëŒ€ê¸° ì¤‘ (5ì´ˆ)...

[1;33mâš ï¸ ì•Œë¦¼ ìƒì„± í™•ì¸ì€ notification-service ë¡œê·¸ ë˜ëŠ” DBë¥¼ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”.[0m
[1;33mì˜ˆìƒ ë¡œê·¸: ğŸšš Received delivery.status.changed event - eventId: test-delivery-event-d99460c5-2686-47fd-afe7-a0aa8cdee4c3[0m

ìˆ˜ë™ ê²€ì¦ ë°©ë²•:
1. Docker ë¡œê·¸ í™•ì¸:
   docker logs notification-service | grep 'test-delivery-event-d99460c5-2686-47fd-afe7-a0aa8cdee4c3'

2. DB í™•ì¸ (H2 Console ë˜ëŠ” PostgreSQL):
   SELECT * FROM p_notifications WHERE event_id = 'test-delivery-event-d99460c5-2686-47fd-afe7-a0aa8cdee4c3';
   (message_type = 'DELIVERY_STATUS_UPDATE' í™•ì¸)

[0;32mâœ… í…ŒìŠ¤íŠ¸ ì™„ë£Œ (ìˆ˜ë™ ê²€ì¦ í•„ìš”)[0m

[0;34m[TEST 4] ë©±ë“±ì„± ê²€ì¦ - ë™ì¼í•œ eventIdë¡œ ì¤‘ë³µ ë°œí–‰ (delivery)[0m
ë™ì¼í•œ Event IDë¡œ ì¬ë°œí–‰: test-delivery-event-d99460c5-2686-47fd-afe7-a0aa8cdee4c3
âœ… Kafka ë©”ì‹œì§€ ì¬ë°œí–‰ ì™„ë£Œ
â³ Consumer ì²˜ë¦¬ ëŒ€ê¸° ì¤‘ (5ì´ˆ)...

[1;33mâš ï¸ ë©±ë“±ì„± í™•ì¸: ë™ì¼í•œ eventIdë¡œ 2ë²ˆ ë°œí–‰í–ˆì§€ë§Œ, ì•Œë¦¼ì€ 1ê°œë§Œ ìƒì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.[0m
[1;33mì˜ˆìƒ ë¡œê·¸: â­ï¸ Event already processed (idempotency) - eventId: test-delivery-event-d99460c5-2686-47fd-afe7-a0aa8cdee4c3[0m

ìˆ˜ë™ ê²€ì¦ ë°©ë²•:
1. Docker ë¡œê·¸ í™•ì¸ (ë©±ë“±ì„± ë¡œê·¸):
   docker logs notification-service | grep 'idempotency' | grep 'test-delivery-event-d99460c5-2686-47fd-afe7-a0aa8cdee4c3'

2. DB í™•ì¸ (1ê°œë§Œ ì¡´ì¬í•´ì•¼ í•¨):
   SELECT COUNT(*) FROM p_notifications WHERE event_id = 'test-delivery-event-d99460c5-2686-47fd-afe7-a0aa8cdee4c3';
   (ê²°ê³¼: 1)

[0;32mâœ… í…ŒìŠ¤íŠ¸ ì™„ë£Œ (ìˆ˜ë™ ê²€ì¦ í•„ìš”)[0m

========================================
Test Summary
========================================
Total Tests: 4
[0;32mCompleted: 4[0m
End Time: 2025ë…„ 11ì›” 13ì¼ ëª© ì˜¤í›„ 12:10:29

[0;32mâœ… Kafka Consumer í…ŒìŠ¤íŠ¸ ì™„ë£Œ![0m

[1;33mğŸ“ ì°¸ê³ : ì´ í…ŒìŠ¤íŠ¸ëŠ” ìˆ˜ë™ ê²€ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.[0m
[1;33m   Docker ë¡œê·¸ ë˜ëŠ” DBë¥¼ í™•ì¸í•˜ì—¬ ì•Œë¦¼ ìƒì„± ë° ë©±ë“±ì„±ì„ ê²€ì¦í•˜ì„¸ìš”.[0m

Results saved to: /c/Users/gy990/OneDrive/GYP/14.Master_Java/02.workspace/one-for-logis/notification-service/test-results/kafka-test-20251113-120939.log
